angular.module('debate-visualization')
  .controller('appController', ['$scope','$http',
    ($scope, $http) ->
      self = this;
      $http.get("<%= asset_path 'data/analysis_hillary.json' %>").then( (response) ->
        json = response.data;
        words = Object.keys(json).map( (d) ->
          summary = json[d]
          summary["text"] = d
          return summary
        );
        self.hillary_words = words
      );
      $http.get("<%= asset_path 'data/analysis_trump.json' %>").then( (response) ->
        json = response.data;
        words = Object.keys(json).map( (d) ->
          summary = json[d]
          summary["text"] = d
          return summary
        );
        self.trump_words = words;
      );

      self.dem_blue = tinycolor("rgb(35,32,102");
      self.rep_red = tinycolor("rgb(233,29,14)");
      self.positive = tinycolor("rgb(32, 175, 0)");
      self.negative = tinycolor("rgb(232, 116, 0)");

      self.hillary_bio = "<%= asset_path 'layout/hillary/bio.html' %>";
      self.hillary_tweets = ['617749885933232128'];
      self.hillary_content = "<%= asset_path 'layout/hillary/content.html' %>";

      self.trump_bio = "<%= asset_path 'layout/trump/bio.html' %>";
      self.trump_tweets = ['617749885933232128'];
      self.trump_content = "<%= asset_path 'layout/trump/content.html' %>";

      $scope.$on("render-done", (event, element) ->
        element.closest(".collapse").collapse();
      );

      return;
  ]);
